<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Location Prediction Form</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='magnitude.css') }}">
    <script>
        function validateForm() {
            const form = document.forms["locationForm"];
            const fields = ["depth", "magnitude", "no_of_stations", "gap", "close", "rms"];
            const fieldNames = ["Depth", "Magnitude", "No of Stations", "Gap", "Close", "RMS"];
            for (let i = 0; i < fields.length; i++) {
                let value = form[fields[i]].value;
                if (isNaN(value) || value.trim() === "") {
                    alert(fieldNames[i] + " must be a valid float.");
                    return false;
                }
            }
            return true;
        }

        function scrollToPrediction() {
            const prediction = document.getElementById("prediction");
            if (prediction) {
                prediction.scrollIntoView({ behavior: "smooth" });
            }
        }

        function resetForm() {
            const form = document.getElementById("locationForm");
            const fields = ["depth", "magnitude", "no_of_stations", "gap", "close", "rms"];
            fields.forEach(field => {
                form[field].value = '';
            });
            const predictionContainer = document.getElementById("prediction");
            if (predictionContainer) {
                predictionContainer.remove();
            }
        }
    </script>
</head>

<body onload="scrollToPrediction()">
    <div class="form-wrapper">
        <div class="form-container">
            <h2>Enter Location Prediction Details</h2>
            <form id="locationForm" name="locationForm" action="/location" method="post" onsubmit="return validateForm()">
                <label for="depth">Depth (km):</label>
                <input type="text" id="depth" name="depth" value="{{ request.form['depth'] if request.form['depth'] else '' }}"><br>

                <label for="magnitude">Magnitude (ergs):</label>
                <input type="text" id="magnitude" name="magnitude" value="{{ request.form['magnitude'] if request.form['magnitude'] else '' }}"><br>

                <label for="no_of_stations">No of Stations:</label>
                <input type="text" id="no_of_stations" name="no_of_stations" value="{{ request.form['no_of_stations'] if request.form['no_of_stations'] else '' }}"><br>

                <label for="gap">Gap:</label>
                <input type="text" id="gap" name="gap" value="{{ request.form['gap'] if request.form['gap'] else '' }}"><br>

                <label for="close">Close:</label>
                <input type="text" id="close" name="close" value="{{ request.form['close'] if request.form['close'] else '' }}"><br>

                <label for="rms">RMS:</label>
                <input type="text" id="rms" name="rms" value="{{ request.form['rms'] if request.form['rms'] else '' }}"><br>

                <input type="submit" value="Submit">
            </form>
        </div>
    </div>

    {% if prediction %}
    <div class="prediction" id="prediction">
        <div><b>Predicted Location</b></div>
        <br> 
        <div>Latitude -> {{ prediction[0][0] }}</div>
        <div>Longitude -> {{ prediction[0][1] }}</div>
        <button onclick="resetForm()" class="reset-button">Reset</button>
    </div>
    {% endif %}

    {% if error %}
    <div class="error">{{ error }}</div>
    {% endif %}
</body>
</html>
